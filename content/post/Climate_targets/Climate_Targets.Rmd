---
title: "Australian and Canadian missed climate targets"

output:
  html_document:
    df_print: paged
    fig_width: 7
    fig_height: 5

editor_options: 
  chunk_output_type: inline

date: 2018-12-30
lastmod: 2019-02-01

slug: "ClimateTargets"

draft: false

---

```{r setup,include=FALSE}
##########################################
## Initialize
##########################################
knitr::opts_chunk$set(echo=FALSE,include=FALSE)
#knitr::opts_knit$set(root.dir = normalizePath(".."))

library(readr)
library(tidyr)
library(dplyr)
library(reshape2)
library(readxl)
library(ggrepel)
library(knitr)
library("RColorBrewer")
library(ggplot2)
library(kableExtra)
library('scales') # for the percent function
rm(list=ls())

```

```{r}
##########################################
## Import Canadian Data for trends and targets
##########################################
getwd()
#Use 2017 NIR data as this appears to be what was used when making the future emission trend projections in the Auditor General Report
#Use IPCC data so that LULUCF can be included

## Import Sector Definitions
CDN_IPCC_def <- read_excel("Data_AUCDN_targets/CanadaAU_SectorCrosswalk.xlsx",sheet = "CDN_IPCC",range = "A3:D85")

## Import 2017 Cdn IPCC data
CDN_IPCC_Data <- read_excel("Data_AUCDN_targets/EN-Tables_CA_1990-2015_Unrounded_Data.xlsx",sheet = "Summary",range = "A5:AE88")

colnames(CDN_IPCC_Data)[1] <- "CDN_Cat1"
colnames(CDN_IPCC_Data)[2] <- "CDN_Cat2"
colnames(CDN_IPCC_Data)[3] <- "CDN_Cat3"
CDN_IPCC_Data <- select(CDN_IPCC_Data,-"...4",-"...5")

#Merge in IPCC definitions
CDN_IPCC_Data <- merge(CDN_IPCC_Data,CDN_IPCC_def,by=c("CDN_Cat1","CDN_Cat2","CDN_Cat3"),all=FALSE)
CDN_IPCC_Data <- rename(CDN_IPCC_Data,"IPCC_Sector"="IPCC NIR Sector")

#Merge in useful definitions to use in place of IPCC sectors
Sector_def <- read_excel("Data_AUCDN_targets/CanadaAU_SectorCrosswalk.xlsx",sheet = "List of sectors")
Sector_def <- rename(Sector_def,"IPCC_Sector"="IPCC NIR Sector")
Sector_def <- filter(Sector_def,IPCC_Sector!="From IPCC Sector Definitions for NIR CIF Tables")

#use Convenient_Name2 renamed as Convenient_Name
CDN_IPCC_Data <- merge(CDN_IPCC_Data,Sector_def,by=c("IPCC_Sector"),all=FALSE)
CDN_IPCC_Data <- select(CDN_IPCC_Data,-IPCC_Sector,-CDN_Cat1,-CDN_Cat2,-CDN_Cat3,-Convenient_Name)
CDN_IPCC_Data <- rename(CDN_IPCC_Data,Convenient_Name=Convenient_Name2)

#reshape into long format
CDN_IPCC_Data <- CDN_IPCC_Data %>% gather("year","GHGs",-GHGCat,-SubCat1,-SubCat2,-SubCat3,-Convenient_Name) %>% transform(GHGs = as.numeric(GHGs))  %>% transform(year = as.numeric(year))

#Convert GHGs to MtCO2eq from ktCO2eq
CDN_IPCC_Data$GHGs <- CDN_IPCC_Data$GHGs/1000

#drop values with missing GHGs
CDN_IPCC_Data <- filter(CDN_IPCC_Data,!is.na(CDN_IPCC_Data$GHGs))

#replace all is.na with "Total" so that I can use these as grouping variables in aggregate
CDN_IPCC_Data[is.na(CDN_IPCC_Data)] <- "Total"
#str(CDN_IPCC_Data)

#aggregate building category 
CDN_IPCC_Data$SubCat2[CDN_IPCC_Data$SubCat2=="Commercial and Institutional"] <- "Buildings" 
CDN_IPCC_Data$SubCat2[CDN_IPCC_Data$SubCat2=="Residential"] <- "Buildings"
CDN_IPCC_Data <- aggregate(GHGs~.,data=CDN_IPCC_Data,FUN=sum)

#change GHGCat text to lowercase
CDN_IPCC_Data$GHGCat <- sapply(CDN_IPCC_Data$GHGCat,FUN=tolower)
library(Hmisc)
CDN_IPCC_Data$GHGCat <- capitalize(CDN_IPCC_Data$GHGCat)

#Generate Total_Energy and Total_withLULUCF.  Subset, summarise, save?
CDN_IPCC_Data$GHGCat[CDN_IPCC_Data$GHGCat=="Total"] <- "Total_Energy"
CDN_IPCC_Data$Convenient_Name[CDN_IPCC_Data$GHGCat=="Total_Energy"] <- "Total_Energy"

temp <- subset(CDN_IPCC_Data,SubCat1=="Total" & GHGCat!="Total_Energy") %>% group_by(year) %>% summarise(GHGs=sum(GHGs))
#other option is to use ddply
temp <- mutate(temp,GHGCat="Total_withLULUCF",SubCat1="Total",SubCat2="Total",SubCat3="Total",Convenient_Name="Total_withLULUCF")
CDN_IPCC_Data <- rbind(CDN_IPCC_Data,temp)
CDN_IPCC_Data <- mutate(CDN_IPCC_Data,Type="Historical")

#This data can be used for both country-sector break downs, and projections. But for breakdowns (future post) might want to use 2018 NIR data to get 1 more year.

```


```{r}
#Import projected emissions and targets. Want projected emissions to be one file, and targets in another

#Importing Canadian emissions projections from AuditorGeneral2018ProjectedEmissions.xlsx
CDN_GHGProjections <- read_excel("Data_AUCDN_targets/AuditorGeneral2018ProjectedEmissions.xlsx",range = "A2:E43")
#View(GHGProjections)
CDN_GHGProjections <- rename(CDN_GHGProjections,"CurrentActions"="Projected with actions in place","AdditionalActions"="Projected with additional actions","WithAllowances"="Projected with additional actions and purchases of allowances")

#Merge CDN_GHGProjections with CDN_IPCC_Data
CDN_GHGProjections <- filter(CDN_GHGProjections,!is.na(CDN_GHGProjections$CurrentActions))
CDN_GHGProjections <- select(CDN_GHGProjections,-Historical)

CDN_GHGProjections <- gather(CDN_GHGProjections,"Type","GHGs",-year)
CDN_GHGProjections <- mutate(CDN_GHGProjections,Convenient_Name="Total_Energy")

#How to incorporate LULUCF in projecting Canadian emissions?
#Extrapolate out the 2015 LULUCF, add to Total_Energy to get projected Total_withLULUCF
temp <- CDN_IPCC_Data %>% filter(year==2015 & Convenient_Name=="LULUCF") %>% select(GHGs)

#temporary LULUCF projected
temp2 <- CDN_GHGProjections
temp2$Convenient_Name <- "LULUCF"
temp2$GHGs <- temp$GHGs

#temporary Total_withLULUCF
temp3 <- CDN_GHGProjections
temp3$Convenient_Name <- "Total_withLULUCF"
temp3$GHGs <- CDN_GHGProjections$GHGs + temp$GHGs

CDN_GHGProjections <- rbind(CDN_GHGProjections,temp2,temp3)
rm(temp,temp2,temp3)

#combine projections and historical data  
CDN_IPCC_Data <- bind_rows(CDN_IPCC_Data,CDN_GHGProjections)

#impute the 2015 value from Historical into CurrentActions, etc, so that when plotting the line these are continuous values. extract 2015 value
types <- unique(subset(CDN_IPCC_Data$Type,CDN_IPCC_Data$Type!="Historical"))
temp <- subset(CDN_IPCC_Data,Type=="Historical" & year==2015 & (Convenient_Name %in% c("LULUCF","Total_Energy","Total_withLULUCF")))

temp$Type <- types[1]
CDN_IPCC_Data <- rbind(CDN_IPCC_Data,temp)

temp$Type <- types[2]
CDN_IPCC_Data <- rbind(CDN_IPCC_Data,temp)

temp$Type <- types[3]
CDN_IPCC_Data <- rbind(CDN_IPCC_Data,temp)

```


```{r}
## Import AU Data, plot targets
#use AU projected emissions data, which includes LULUCF
AU_IPCC_Data <- read_excel("Data_AUCDN_targets/aust-emissions-projects-chart-data-2017.xlsx",sheet="Figure 3",skip=2)
#generate total excluding LULUCF
AU_IPCC_Data <- AU_IPCC_Data %>% filter(is.na(AU_IPCC_Data$"1990")==0) %>% rename("Convenient_Name"="...1") %>% gather(key=year,value=GHGs,-Convenient_Name) 
AU_IPCC_Data$year <- as.numeric(AU_IPCC_Data$year)

AU_IPCC_Data$Convenient_Name[AU_IPCC_Data$Convenient_Name=="Total (incl. LULUCF)"] <- "Total_withLULUCF"

#Create subcatory of Total_Energy
temp <- subset(AU_IPCC_Data,Convenient_Name!="LULUCF" & Convenient_Name!="Total_withLULUCF") %>% group_by(year) %>% summarise(GHGs=sum(GHGs))
#other option is to use ddply
temp <- mutate(temp,Convenient_Name="Total_Energy")

AU_IPCC_Data <- bind_rows(AU_IPCC_Data,temp)

#Split AU data into CurrentActions and regular data
#Split by year>=2017
AU_IPCC_Data <- mutate(AU_IPCC_Data,Type="Historical")
AU_IPCC_Data$Type[AU_IPCC_Data$year>2016] <- "CurrentActions"

#impute the 2015 value from Historical into CurrentActions so that when plotting the line these are continuous values. Extract 2016 value
types <- unique(subset(AU_IPCC_Data$Type,AU_IPCC_Data$Type!="Historical"))

temp <- subset(AU_IPCC_Data,Type=="Historical" & year==2016 & (Convenient_Name %in% c("LULUCF","Total_Energy","Total_withLULUCF")))

temp$Type <- types[1]
AU_IPCC_Data <- rbind(AU_IPCC_Data,temp)
```

```{r}
#Merge Cdn and AU data
temp1 <- AU_IPCC_Data %>% mutate(cty="AU") %>% filter(Convenient_Name %in% c("Total_Energy","Total_withLULUCF","LULUCF"))
temp2 <- CDN_IPCC_Data %>% mutate(cty="CDN") %>% filter(Convenient_Name %in% c("Total_Energy","Total_withLULUCF","LULUCF")) %>% select(-GHGCat,-SubCat1,-SubCat2,-SubCat3)
IPCC_Data <- rbind(temp1,temp2)
rm(temp1,temp2)

```

```{r}
#Make dataframe with GHG targets
GHGTargets <- read_excel("Data_AUCDN_targets/EmissionTargets.xlsx")
#Toronto target base year is 1988; this needs to be changed to 1990
GHGTargets$BaseYear[GHGTargets$BaseYear==1988] <- 1990

#Need to convert percent reduction targets imported from EmissionTargets.xlsx into start and end emission levels, for both Total_Energy and Total_withLULUCF GHGs. This is complicated by different targets using different accounting systems and different treatments of LULUCF. Solution is to use AU projections, use reductions on non-LULUCF, show LULUCF vs ex-LULUCF, and show adjusted Paris baseline and target.

#Merge in GHGs at SignYear, the start point for plotting
temp1 <- inner_join(GHGTargets,subset(IPCC_Data,Type=="Historical" & Convenient_Name!="LULUCF"),by=c("SignYear"="year","cty"="cty"))
temp1 <- temp1 %>% select(-BaseYear,-TargetYear,-TargetPC,-Type) %>% rename(year=SignYear) %>% mutate(Trend="Start")

#merge in Total_Energy and Total_withLULUCF for BaseYear and cty, and create target level and target year.
temp2 <- inner_join(GHGTargets,subset(IPCC_Data,Type=="Historical" & Convenient_Name!="LULUCF"),by=c("BaseYear"="year","cty"="cty"))
temp2 <- mutate(temp2,TargetYearGHGs=GHGs*(1+TargetPC))
temp2 <- temp2 %>% select(-SignYear,-BaseYear,-TargetPC,-Type,-GHGs) %>% rename(year=TargetYear,GHGs=TargetYearGHGs) %>% mutate(Trend="End")

GHGTargets_levels <- rbind(temp1,temp2)
rm(temp1,temp2)

```


```{r,include=FALSE,fig.width=7,fig.height=5}
#Plot Canadian GHGs + targets for both Total_Energy and Total_withLULUCF
#Excluding LULUCF
#ggsave("Figures/CanadianGHGTargets.png",width = 7, height =5, units = "in")
CDN_targets_exLULUCF <- ggplot(IPCC_Data,aes(x=year)) + 
  geom_line(data=subset(GHGTargets_levels,cty=="CDN" & Convenient_Name=="Total_Energy"),aes(x=year,y=GHGs,group=Agreement),linetype=1,colour="gray85",size=0.8) + 
  geom_line(data=subset(IPCC_Data,cty=="CDN" & Convenient_Name=="Total_Energy" & Type!="AdditionalActions"),aes(y=GHGs,colour=Type,linetype=Type),size=1.2) +
  scale_linetype_manual(values=c("Historical"=1,"CurrentActions"=2,"WithAllowances"=2),breaks=c("Historical","CurrentActions","WithAllowances"),labels=c("Greenhouse Gas Emissions   ","Projected: 2017 Policies   ","Projected: Planned Policies")) +
  scale_color_manual(values=c("Historical"="firebrick3","CurrentActions"="orangered1","WithAllowances"="forestgreen"),breaks=c("Historical","CurrentActions","WithAllowances"),labels=c("Greenhouse Gas Emissions   ","Projected: 2017 Policies   ","Projected: Planned Policies")) +
  geom_point(data=subset(GHGTargets_levels,cty=="CDN" & Trend=="End" & Convenient_Name=="Total_Energy"),aes(x=year,y=GHGs),size=2) +
  theme_bw() +
  geom_label_repel(data=subset(GHGTargets_levels,cty=="CDN" & Trend=="End" & Convenient_Name=="Total_Energy" & (Agreement %in% c("Toronto target"))),aes(x=year,y=GHGs,label=subset(GHGTargets_levels,cty=="CDN" & Trend=="End" & Convenient_Name=="Total_Energy" & (Agreement %in% c("Toronto target")))$Agreement),direction="x",hjust=1,vjust=0,size=3) + 
  geom_label_repel(data=subset(GHGTargets_levels,cty=="CDN" & Trend=="End" & Convenient_Name=="Total_Energy" & (Agreement %in% c("Rio target","Kyoto target","Paris target"))),aes(x=year,y=GHGs,label=subset(GHGTargets_levels,cty=="CDN" & Trend=="End" & Convenient_Name=="Total_Energy" & (Agreement %in% c("Rio target","Kyoto target","Paris target")))$Agreement),direction="x",hjust=0,vjust=1,size=3) + 
  geom_label_repel(data=subset(GHGTargets_levels,cty=="CDN" & Trend=="End" & Convenient_Name=="Total_Energy" & (Agreement %in% c("Copenhagen target"))),aes(x=year,y=GHGs,label=subset(GHGTargets_levels,cty=="CDN" & Trend=="End" & Convenient_Name=="Total_Energy" & (Agreement %in% c("Copenhagen target")))$Agreement),direction="x",hjust=0,vjust=1,size=3) + 
  scale_x_continuous(breaks=seq(1990,2030,5)) + scale_y_continuous(breaks=seq(450,800,50)) + 
  labs(title="Canadian Greenhouse Gas Emissions and Reduction Targets", subtitle="Excluding LULUCF Emissions", y=expression('Emissions (Mt CO'[2]*'eq)'), x=element_blank(), caption="Plot by @alastairfraser") + coord_cartesian(ylim=c(450,800)) + 
  guides(linetype=guide_legend(nrow=1)) + 
  theme(
    legend.position="bottom",
    legend.title=element_blank(),
    legend.justification = c("center", "bottom"),
    plot.caption = element_text(vjust = 2),
    legend.key.width = unit(1.25,"cm"),
    legend.margin=margin(0,0,0,0),
    legend.box.margin=margin(-10,0,0,0),
    panel.grid.major = element_line(size = 0.2, linetype = 'solid',
                                colour = "grey95"), 
    panel.grid.minor = element_line(size = 0.15, linetype = 'solid',
                                colour = "white"))
plot(CDN_targets_exLULUCF)

```

```{r,include=FALSE,fig.width=7,fig.height=5}
################################################
#Plot AU emissions
################################################
# Plot Total_Energy to start
# Excluding LULUCF
AU_targets_exLULUCF <- ggplot(IPCC_Data,aes(x=year)) + 
  geom_line(data=subset(GHGTargets_levels,cty=="AU" & Convenient_Name=="Total_Energy" & Trend!="KP Baseline" & Agreement!="Kyoto target (Australia clause)"),aes(x=year,y=GHGs,group=Agreement),linetype=1,colour="gray85",size=0.8)  + 
  geom_line(data=subset(IPCC_Data,cty=="AU" & Convenient_Name=="Total_Energy"),aes(y=GHGs,colour=Type,linetype=Type),size=1.2) +
  scale_linetype_manual(values=c("Historical"=1,"CurrentActions"=2),breaks=c("Historical","CurrentActions"),labels=c("Historical Emissions          ","Projected: Current Policies")) +
  scale_color_manual(values=c("Historical"="firebrick3","CurrentActions"="orangered1"),breaks=c("Historical","CurrentActions"),labels=c("Historical Emissions          ","Projected: Current Policies")) + 
  geom_point(data=subset(GHGTargets_levels,cty=="AU" & Trend=="End" & Convenient_Name=="Total_Energy"  & Agreement!="Kyoto target (Australia clause)" ),aes(x=year,y=GHGs),size=2) + 
  theme_bw() + 
  geom_label_repel(data=subset(GHGTargets_levels,cty=="AU" & Trend=="End" & Convenient_Name=="Total_Energy" & (Agreement %in% c("Rio target","Kyoto target"))),aes(x=year,y=GHGs,label=subset(GHGTargets_levels,cty=="AU" & Trend=="End" & Convenient_Name=="Total_Energy" & (Agreement %in% c("Rio target","Kyoto target")))$Agreement),direction="x",hjust=1,vjust=1,size=3) + 
  geom_label_repel(data=subset(GHGTargets_levels,cty=="AU" & Trend=="End" & Convenient_Name=="Total_Energy" & (Agreement %in% c("Toronto target","Copenhagen target"))),aes(x=year,y=GHGs,label=subset(GHGTargets_levels,cty=="AU" & Trend=="End" & Convenient_Name=="Total_Energy" & (Agreement %in% c("Toronto target","Copenhagen target")))$Agreement),direction="x",hjust=1,vjust=0,size=3) + 
  geom_label_repel(data=subset(GHGTargets_levels,cty=="AU" & Trend=="End" & Convenient_Name=="Total_Energy" & (Agreement %in% c("Paris target"))),aes(x=year,y=GHGs,label=subset(GHGTargets_levels,cty=="AU" & Trend=="End" & Convenient_Name=="Total_Energy" & (Agreement %in% c("Paris target")))$Agreement),direction="x",hjust=0,vjust=1,size=3) + 
  scale_x_continuous(breaks=seq(1990,2030,5)) + scale_y_continuous(breaks=seq(300,600,50)) + 
  labs(title="Australian Greenhouse Gas Emissions & Targets", subtitle="Excluding LULUCF", y=expression('Emissions (Mt CO'[2]*'eq)'), x=element_blank(), caption="Plot by @alastairfraser") + coord_cartesian(ylim=c(300,600)) +
    guides(linetype=guide_legend(ncol=2)) + 
  theme(
    legend.position="bottom",
    legend.title=element_blank(),
    legend.justification = c("center", "bottom"),
    plot.caption = element_text(vjust = 1),
    legend.key.width = unit(2,"cm"),
    legend.margin=margin(0,0,0,0),
    legend.box.margin=margin(-15,0,0,0))  

plot(AU_targets_exLULUCF)

```


```{r,include=FALSE,fig.width=7,fig.height=5}
# Including LULUCF
AU_targets_incLULUCF <- ggplot(IPCC_Data,aes(x=year)) + 
  geom_line(data=subset(GHGTargets_levels,cty=="AU" & Convenient_Name=="Total_withLULUCF"),aes(x=year,y=GHGs,group=Agreement),linetype=1,colour="gray85",size=0.8)  + 
  geom_line(data=subset(IPCC_Data,cty=="AU" & Convenient_Name=="Total_withLULUCF"),aes(y=GHGs,colour=Type,linetype=Type),size=1.2) +
  scale_linetype_manual(values=c("Historical"=1,"CurrentActions"=2),breaks=c("Historical","CurrentActions"),labels=c("Historical Emissions          ","Projected: Current Policies")) +
  scale_color_manual(values=c("Historical"="firebrick3","CurrentActions"="orangered1"),breaks=c("Historical","CurrentActions"),labels=c("Historical Emissions          ","Projected: Current Policies")) + 
  geom_point(data=subset(GHGTargets_levels,cty=="AU" & Trend=="End" & Convenient_Name=="Total_withLULUCF"),aes(x=year,y=GHGs)) + 
  theme_bw() + 
  geom_label_repel(data=subset(GHGTargets_levels,cty=="AU" & Trend=="End" & Convenient_Name=="Total_withLULUCF" & (Agreement %in% c("Toronto target","Kyoto target","Copenhagen target"))),aes(x=year,y=GHGs,label=subset(GHGTargets_levels,cty=="AU" & Trend=="End" & Convenient_Name=="Total_withLULUCF" & (Agreement %in% c("Toronto target","Kyoto target","Copenhagen target")))$Agreement),direction="x",hjust=1,vjust=0,size=3) + 
  geom_label_repel(data=subset(GHGTargets_levels,cty=="AU" & Trend=="End" & Convenient_Name=="Total_withLULUCF" & (Agreement %in% c("Paris target"))),aes(x=year,y=GHGs,label=subset(GHGTargets_levels,cty=="AU" & Trend=="End" & Convenient_Name=="Total_withLULUCF" & (Agreement %in% c("Paris target")))$Agreement),direction="x",hjust=0,vjust=1,size=3) + 
  geom_label_repel(data=subset(GHGTargets_levels,cty=="AU" & Trend=="End" & Convenient_Name=="Total_withLULUCF" & (Agreement %in% c("Rio target"))),aes(x=year,y=GHGs,label=subset(GHGTargets_levels,cty=="AU" & Trend=="End" & Convenient_Name=="Total_withLULUCF" & (Agreement %in% c("Rio target")))$Agreement),direction="x",hjust=0,vjust=0,size=3) + 
  scale_x_continuous(breaks=seq(1990,2030,5)) + scale_y_continuous(breaks=seq(400,650,50)) + 
  labs(title="Australian Greenhouse Gas Emissions & Targets", subtitle="Including LULUCF", y=expression('Emissions (Mt CO'[2]*'eq)'), x=element_blank(), caption="Plot by @alastairfraser") + coord_cartesian(ylim=c(400,650)) +
    guides(linetype=guide_legend(ncol=2)) + 
  theme(
    legend.position="bottom",
    legend.title=element_blank(),
    legend.justification = c("center", "bottom"),
    plot.caption = element_text(vjust = 1),
    legend.key.width = unit(2,"cm"),
    legend.margin=margin(0,0,0,0),
    legend.box.margin=margin(-15,0,0,0))  

plot(AU_targets_incLULUCF)
```

```{r,include=FALSE}
#Plot LULUCF vs Total_Energy categories

temp <- IPCC_Data %>% filter(Type=="Historical") %>% select(-Type)
str(temp$cty)
levels(temp$cty)

temp$cty <- factor(temp$cty)
str(temp$cty)
levels(temp$cty)

temp$cty <- factor(temp$cty,labels=c("Australia","Canada"))

CompareLULUCF_Emissions <- ggplot(data=temp,aes(x=year,y=GHGs)) +  geom_line(aes(color=Convenient_Name,size=Convenient_Name)) + theme_bw() + 
  geom_hline(yintercept=0, color="grey10") +
  scale_color_manual(values=c("Total_Energy"="firebrick3","LULUCF"="green4","Total_withLULUCF"="grey50"),breaks=c("Total_Energy","LULUCF","Total_withLULUCF"),labels=c("Emissions excluding LULUCF     ","LULUCF Emissions     ","Total Emissions")) + 
  scale_size_manual(breaks=c("Total_Energy","LULUCF","Total_withLULUCF"),labels=c("Emissions excluding LULUCF     ","LULUCF Emissions     ","Total Emissions"),values=c(1.2,1.2,0.7)) +
  labs(title="1990-2016 Greenhouse Gas Emissions", subtitle=element_blank(),
     y=expression('Emissions (Mt CO'[2]*'eq)'),
     x=element_blank()) +
  theme(legend.position="bottom",
    legend.title=element_blank(),
    legend.justification = c("center", "bottom"),
    plot.caption = element_text(vjust = 2),
    legend.key.width = unit(1.5,"cm"),
    legend.margin=margin(0,0,0,0),
    legend.box.margin=margin(-10,0,0,0)) +
  facet_grid(cols=vars(cty))

plot(CompareLULUCF_Emissions)

```

We hear a lot about plans to reduce greenhouse gas emissions, yet comparably little about how we've lived up to past commitments. It's worth taking a look at our past (in)actions and goals as they're important context in which to view current progress. 

It's not an optimistic picture. Without a change in direction the Paris target is well on track to joining past failed targets, with voters and politicians again kicking the climate can down the road as a problem for future generations to pay the growing costs of.

The Canadian and Australian governments have made public statements on five greenhouse gas reduction targets (see bottom of the post for details). While most of these targets are the result of the [United Nations Framework Convention on Climate Change](https://unfccc.int/) (UNFCCC) process and will sound familiar, the Toronto target is rarely mentioned but particularly interesting given current politics. Arguably the first Canadian greenhouse gas emission reduction target, it resulted from the [Toronto Conference on the Changing Atmosphere](https://www.nytimes.com/1988/06/28/science/norway-and-canada-call-for-pact-to-protect-atmosphere.html) supported by the Progressive Conservative government of Brian Mulroney. It's the only international target adopted unofficially by the Canadian and Australian governments without a signed multilateral agreement.

Greenhouse gas reduction targets consist of four key pieces of information: a baseline year that defines the starting level of greenhouse gas emissions, a target percentage reduction in (or limited increase in) emissions, the year by which a reduction target should be achieved, and --- more on this later, as it's critical to Australia's targets --- a definition of what emissions must be accounted for. Here's the Canadian and Australian emission reduction targets. 

```{r,include=TRUE,results='asis'}
GHGTargetsTable <- GHGTargets %>% select(cty,Agreement,BaseYear,TargetYear,TargetPC,SignYear)
GHGTargetsTable <- rename(GHGTargetsTable,"Baseline Year"=BaseYear,"Country"=cty,"Target Year"=TargetYear,"Target"=TargetPC,"Year Signed"=SignYear)
GHGTargetsTable$Country[GHGTargetsTable$Country=="CDN"] <- "Canada"
GHGTargetsTable$Country[GHGTargetsTable$Country=="AU"] <- "Australia"
GHGTargetsTable$Agreement[GHGTargetsTable$Agreement=="Toronto target"] <- "Toronto Conference on the Changing Atmosphere"
GHGTargetsTable$Agreement[GHGTargetsTable$Agreement=="Rio target"] <- "Rio de Janeiro Earth Summit"
GHGTargetsTable$Agreement[GHGTargetsTable$Agreement=="Kyoto target"] <- "Kyoto Protocol"
GHGTargetsTable$Agreement[GHGTargetsTable$Agreement=="Copenhagen target"] <- "Copenhagen Accord"
GHGTargetsTable$Agreement[GHGTargetsTable$Agreement=="Paris target"] <- "Paris Agreement"

GHGTargetsTable$Target <- percent(GHGTargetsTable$Target,accuracy=1)
#https://haozhu233.github.io/kableExtra/awesome_table_in_html.html

kable(GHGTargetsTable[,2:5],align=c("l","c","c","c","c","c","c"),caption="Canadian and Australian greenhouse gas reduction targets",format="html",linesep = c('','','\\hline')) %>%
  kable_styling(bootstrap_options = c("striped", "hover","condensed"),full_width = F) %>% 
  group_rows("Canada", 1, 5) %>%   group_rows("Australia", 6, 10)  

```

Comparing targets is complicated by the fact that they use different definitions of emissions, especially for land-use, land-use change, and forestry (LULUCF) sources. In addition, countries could sometimes choose whether or not to include LULUCF emissions towards their targets, which further complicates comparisons. Including LULUCF emissions has little impact on Canada's targets, but a substantial impact on Australia's.

To simplify the comparison, I'll start by excluding LULUCF emissions, then discuss how including LULUCF affects Australia. Canada has announced that it intends to account for LULUCF emissions in meeting the Paris Target, but the accounting rules have not yet been decided. 

Here's Canada's greenhouse gas emissions, reduction targets, and projections of future emissions. 

```{r,include=TRUE,fig.width=7,fig.height=5,fig.align="center"}
plot(CDN_targets_exLULUCF)
```

As of 2016, Canada's greenhouse gas emissions are about 80% from burning fossil fuels, with the other 20% from agriculture, industrial processes, and waste. Emissions rose in the 90's, and have been pretty flat ever since. I've plotted two projections of future emissions from [Environment Canada's Third Biennial Report on Climate Change.](https://www.canada.ca/en/environment-climate-change/services/climate-change/greenhouse-gas-emissions/seventh-national-communication-third-biennial-report.html) The orange "Projected: 2017 Policies" shows expected greenhouse gas emissions with policies that were in place by September 2017, which excludes the Pan-Canadian Framework on Clean Growth and Climate --- PM Justin Trudeau's signature climate plan. The green "Projected: Planned Policies" includes most of the policies in the Pan-Canadian Framework, showing how the Framework is expected to be an excellent first step towards meeting the Paris target. If the current [widespread pressure from conservatives](https://www.macleans.ca/politics/ottawa/a-carbon-tax-just-try-them/) to reduce, or drop entirely, Canada's climate change efforts do not come to pass, then I'm cautiously optimistic we'll finally see some real reductions in emissions.

What's certainly not missing from this picture are laudable climate targets. The grey lines on the figure show a simple reduction path to each target starting from when the targets entered into force (or was announced, in the case of the Toronto target.)

The Paris target clearly comes from a long pedigree of moving climate goal posts, and no substantive reduction in greenhouse gas emissions.

### The picture down under

Australia has a broadly similar track record of rising (non-LULUCF) greenhouse gas emissions, repeatedly moving climate target goal posts, and no substantive progress in reducing these emissions. Like Canada, Australia has not come close to meeting any of its targets. 

```{r,include=TRUE,fig.width=7,fig.height=5,fig.align="center"}
plot(AU_targets_exLULUCF)
```

How then, does Australia claim that it has [*"a proud history of meeting and beating our international commitments on climate change"*](http://www.environment.gov.au/climate-change/publications/factsheet-australias-2030-climate-change-target)?

The reason hinges on how greenhouse gas emissions from land-use, land-use change, and forestry (LULUCF) are accounted for. The graph below shows how these can be be a large share of a countries GHG emissions, such as occurred in Australia (primarily due to deforestation) in the 1990's, or remove emissions from the atmosphere, for example via reforestation, and thus count as negative emissions for the purpose of meeting reduction targets. 

```{r,include=TRUE,fig.align="center"}
plot(CompareLULUCF_Emissions)
```

Changes in LULUCF emissions are particularly important to Australia, and especially to the Kyoto protocol target. Australia negotiated one of the weakest Kyoto targets, an 8% increase over 1990 emissions by 2008-2012. Australia also helped negotiate Article 3.7 of the Kyoto Protocol --- sometimes called the "Australia clause" --- which made their official target easy to achieve. This is covered well [here](https://theconversation.com/australia-hit-its-kyoto-target-but-it-was-more-a-three-inch-putt-than-a-hole-in-one-44731) and [here](https://theconversation.com/factcheck-has-australia-met-its-climate-goals-while-other-nations-make-airy-fairy-promises-44656). The Australia clause allowed countries with positive emissions from deforestation in 1990, like Australia had, to include some of these emissions in setting their 1990 baseline from which emission reductions are calculated. But by the time the Kyoto Protocol was negotiated in 1997, Australia knew that deforestation emissions had already greatly declined. Australia in effect received credit for having already reduced its substantial deforestation rates, allowing it to further increase emissions from fossil fuels and other sources. 

Here's what the 108% Kyoto target, and other targets, look like when LULUCF emissions are included. By including LULUCF emissions, Australia has achieved it's Kyoto target. 

```{r,include=TRUE,fig.align="center"}
plot(AU_targets_incLULUCF)
```


A caveat is in order here. The Kyoto Protocol used older definitions of emission sources like those from LULUCF, included only some LULUCF sources, had two commitment periods, and defined the target as a 5 year carbon budget rather than a specific goal to be achieved by a single year. As a result, this graph should be seen as broadly representative of the target and reasons it was achieved, rather than an exact match to the target officially declared by Australia. This [series of posts by Tim Baxter](https://timsenvironment.wordpress.com/the-transfer-of-credit-from-kyoto-to-paris-explaining-kyoto-credits-australia-and-the-emissions-budget-for-paris-part-3/) 
discusses some of these issues in more detail, and in particular how the Australia clause and credit for LULUCF emissions will transfer over to the Copenhagen and Paris targets. 

Regardless of whether LULUCF emissions are included or not, it's clear that past greenhouse gas reduction targets aren't a source of optimism for Canada and Australia meeting their Paris commitments. 


### Data Details

To simplify and keep the comparison of targets consistent, all plotted targets are measured based on the percentage target announced with or without LULUCF emissions as indicated on the plot. I do not use the official targets based on KP or other IPCC accounting rules. In general, using official account rules appears to have little effect on the plotted targets. 

##### Canada

  * Historical emissions data is from the 2017 National Inventory Report, available through the [ECCC Datamart](http://data.ec.gc.ca/data/substances/monitor/national-and-provincial-territorial-greenhouse-gas-emission-tables/). I use 2017 data to maintain consistency with the projections of future emissions
  * Projections of future emissions are available from the [3rd Bienniel Report on Climate Change](http://data.ec.gc.ca/data/substances/monitor/canada-s-greenhouse-gas-emissions-projections/?lang=en) or Auditor General Report [Perspectives on Climate Change Action in Canada.](http://www.oag-bvg.gc.ca/internet/English/parl_otp_201803_e_42883.html)

Information on targets comes from a variety of sources.

* Toronto target
    * See "Peter Usher (1989) World Conference on the Changing Atmosphere:
Implications for Global Security, Environment: Science and Policy for Sustainable Development,
31:1, 25-27, DOI: 10.1080/00139157.1989.9929931" [pdf here](https://www.tandfonline.com/doi/pdf/10.1080/00139157.1989.9929931)
    * *Reduce CO2 emissions by approximately 20% of 1988 levels by the
year 2005 as an initial global goal.*
    * Mentioned in HCSC ENSU report ["Kyoto and Beyond: Meeting the Climate Change Challenge"](http://www.ourcommons.ca/DocumentViewer/en/36-1/ENSU/report-2/page-72) 
    * Target defined in percentage terms only; does not specify LULUCF treatment.
    + Debatable whether this is a government target; the original statements by Prime Minister Mulroney and his environment minister Thomas McMillan don't appear to be digitized.
    + The mycommons ENSU committee report states that the Toronto target was recommended by the committee, but the footnote citation link is broken and I couldn't track it down. I haven't bothered to ask the Parliament librarians if they can dig it up, however.

*   Rio target
    + Canada signs the UNFCCC at the 1992 Rio Earth Summit. The wording isn't clear, but does appear to contain a commitment by developed countries to   stabilize GHGs at 1990 levels by 2000. See this [1992 GoC Summary](http://www.res.parl.gc.ca/Content/LOP/ResearchPublicationsArchive/bp1000/bp317-e.asp#3.%20The%20Convention%20on%20Climate%20Change%20and%20Canada(txt)) 
    + In 1990 Brian Mulroney released the Green Plan which, the internet widely reports, contained a target of "*Stabilization of carbon dioxide and other greenhouse gas
emissions at 1990 levels by the year 2000.*" 
    + [PDF here from the GoC](http://cfs.nrcan.gc.ca/pubwarehouse/pdfs/24604.pdf)
    + Text from Rio (see 2.c of the agreement) of the UNFCCC appears to allow for LULUCF in defining stabilization goal.

* Kyoto target
    + [UNFCCC Kyoto Protocol: 6% below 1990 levels by 2012.](https://unfccc.int/process/the-kyoto-protocol)
    + [Canada's Initial Report Under the Kyoto Protocol](https://unfccc.int/files/national_reports/initial_reports_under_the_kyoto_protocol/application/pdf/initial_report_of_canada.pdf)
    + The [A Climate Change Plan for the Purposes of the Kyoto Protocol Implementation Act – 2007](http://www.ec.gc.ca/doc/ed-es/p_123/CC_Plan_2007_e.pdf) includes LULUCF, and defines 1990 emissions (including LULUCF) as 599 MtCO2eq.

* Copenhagen target
    + [Environment Canada states it as 17% reduction from 2005 levels by 2020.](https://www.ec.gc.ca/doc/publications/cc/COM1374/ec-com1374-en-es.htm)
    + Environment Canada's [Emission Trends 2014](https://www.ec.gc.ca/GES-GHG/default.asp?lang=En&n=E0533893-&printfullpage=true&wbdisable=false) defines the specific levels as *Under the Copenhagen Accord, Canada committed to reducing its emissions by 17% from 2005 levels by 2020* with Footnote 1 *As economy-wide emissions in 2005 were 736 Mt, Canada’s implied Copenhagen target is 611 Mt in 2020.*

* Paris target: 30% below 2005 levels by 2030.
    + [Canada's NC7 (3rd bienniel report)](https://www.canada.ca/en/environment-climate-change/services/climate-change/greenhouse-gas-emissions/seventh-national-communication-third-biennial-report.html) currently specifies 517 as the target discussed and notes that work continues on how to include LULUCF sources and sinks in the target and future emission projections.
  
##### Australia  
  
  * Australia provides only a patchwork of GHG data, summarized on the [Department of Environment and Energy](http://www.environment.gov.au/climate-change/climate-science-data/greenhouse-gas-measurement/) page.
      * This links to the a variety of datasets, including [the National Inventory, Quarterly Updates, State, and Sector data.](http://www.environment.gov.au/climate-change/climate-science-data/greenhouse-gas-measurement/publications#national)
      * None of these has a full dataset on AU emissions from 1990 to present. Individual years or state data can be accessed via AGEIS, but not a table of all data. 
      * Using AGEIS [link here](http://ageis.climatechange.gov.au/NGGI.aspx), CIF/IPCC Sector categories can be downloaded.
      * Data must be saved by individual year. Sector categories are not unique; for example, there are multiple "other" categories.
  
  * Emission projections are available through environment.gov.au [here](http://www.environment.gov.au/climate-change/climate-science-data/emissions-projections) and [here](http://www.environment.gov.au/climate-change/publications/emissions-projections-2017)
      * These include an excel file with 1990-2030 emissions and projections, with projections presumably starting in 2017 though the start date isn't clear.
  
Australia Targets

* See this helpful [Australian timeline of emissions targets](https://www.aph.gov.au/About_Parliament/Parliamentary_Departments/Parliamentary_Library/Publications_Archive/Background_Papers/bp9798/98bp04)
  
* Toronto target
    + 20% below 1988 by 2005. 
    + Mentioned in the timeline of emissions above:
    + Does not specify LULUCF or accounting rules
  
* Rio target
    + Reduce to 1990 levels by 2000
    + See [UNFCCC Rio document](https://unfccc.int/resource/docs/convkp/conveng.pdf) which refers to returning to 1990 levels "by the end of the present decade"
    + Mentioned in AU emissions timeline, *The initial agreed target was a stabilisation of greenhouse gas emissions at 1990 levels by 2000.*

* Kyoto Target
    * Two commitment periods 
        + CP1: 108% of 1990 emissions by 2008-2012 period, as described by the [Parliament of Australia.](https://www.aph.gov.au/About_Parliament/Parliamentary_Departments/Parliamentary_Library/Browse_by_Topic/ClimateChangeold/governance/international/theKyoto)
        + CP2: Not considered here.
        + For the Kyoto target I use the endpoint of the CP1, 2012.
    * Uses Kyoto Protocol Accounting Framework
        + AU Government [summary here of GHG measurement and the National Inventory reports](http://www.environment.gov.au/climate-change/climate-science-data/greenhouse-gas-measurement/)
    * The [Australian Government’s Initial Report under the Kyoto Protocol](https://unfccc.int/process/transparency-and-reporting/reporting-and-review-under-the-kyoto-protocol/first-commitment-period/initial-reports-and-initial-review-reports) lists the 1990 assigned amount as 554, and the 108% target as 598.
        + This is close to the [Climate Action Tracker](https://climateactiontracker.org/countries/australia/) target of 592
    * The revised initial report lists the base year 1990 as 547.7, and 108% target as 591.5, for a 5 year budget of 2957.5
        + This is consistent with the Climate Action Tracker, but inconsistent with AGEIS data.
            + Revised Kyoto report: ex LULUCF is 416.155, which is close to the UNFCCC categories (not Kyoto) exLULUCF of 420 and NIR2012 of 415
            + Partial inclusion of deforestation, but not full LULUCF, in setting baseline appears to cause the discrepancy between estimates. 
    * Given Kyoto target, what emissions count towards meeting this baseline?
        + Final CP1 report for AU reports base year of 547.7. This gives a 108% target of 591.516, which over 5 years is 2957.58 which is the assigned amount.
        + AU Kyoto final report is 2008-2012 period (5 years) realized emissions as 2711.153, which is average of 542.
            * This amount matches, exactly, the "Total (without LULUCF)" declared in Table 2 Review of the 2014 Australia Annual Submission, which is Annex A sources excluding LULUCF for 2008-2012, inclusive. 
        + This is close to the energy only emissions for 2008-2012, reported under Kyoto categories of emission projections.
    * If for some reason you've read this far and want more details, feel free to email me.
    * Kyoto True-up report: http://www.environment.gov.au/system/files/resources/0924fd96-2f59-49b4-88df-fe49210a3920/files/trueup-period-report-aus.pdf
        * Cites: https://unfccc.int/sites/default/files/resource/docs/2015/arr/aus.pdf


* Copenhagen target
    * 5% below 2000 by 2020 if there is no global agreement
    * 25% if there is a global agreement
    * The Parliment of Australia article [Copenhagen: a stepping stone](https://www.aph.gov.au/About_Parliament/Parliamentary_Departments/Parliamentary_Library/pubs/BriefingBook43p/copenhagen): 5%-25% below 2000 by 2020.   * UNFCCC [Copenhagen agreement](https://unfccc.int/process/conferences/pastconferences/copenhagen-climate-change-conference-december-2009/statements-and-resources/appendix-i-quantified-economy-wide-emissions-targets-for-2020)
    * Unclear treatment of LULUCF

* Paris target
    * Australia's [Paris target](http://www.environment.gov.au/climate-change/publications/factsheet-australias-2030-climate-change-target) is "26-28% below 2005 levels by 2030" 
      * This includes LULUCF in setting the base year. For more see these links [here](https://theconversation.com/australia-hit-its-kyoto-target-but-it-was-more-a-three-inch-putt-than-a-hole-in-one-44731) and [here](https://www.aph.gov.au/About_Parliament/Parliamentary_Departments/Parliamentary_Library/Publications_Archive/CIB/CIB9798/98CIB10) and [here](https://theconversation.com/factcheck-has-australia-met-its-climate-goals-while-other-nations-make-airy-fairy-promises-44656) and [here](http://www.environment.gov.au/climate-change/publications/factsheet-australias-2030-climate-change-target).
